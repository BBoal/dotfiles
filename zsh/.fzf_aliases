#!/bin/sh

export FZF_DEFAULT_OPTS='
    -1 -0
    --prompt=" "
    --inline-info
    --reverse --height "40%"
    --color fg:242,hl:250,fg+:15,bg+:234,hl+:2
    --color info:108,prompt:235,spinner:108,pointer:1,marker:168
'

alias cdf='cd $(ls -d */ | fzf --reverse --height "40%" --preview "ls {}")'

unalias z 2> /dev/null
z() {
    [ $# -gt 0 ] && _z "$*" && return
    cd "$(_z -l 2>&1 | cat | sed 's/^[^ ]*\ *//' | fzf --height 40% --reverse --inline-info +s --tac --query "$*" --preview "ls {}")" || exit
}

jj() {
    cd "./$(fd -H -td -d5 | fzf --preview 'tree -L 2 ./{}' )" || return 1
}

hc(){
    COMMAND=$(history | fzf | awk '{$1=$2=$3=""; print $0}')
    echo "$COMMAND" && echo "$COMMAND" | sed 's/^\ *//'| pbcopy
}

get_command(){
    history | uniq | awk '{$1=$2=$3=""; print $0}' | fzf --height 40%
}

ss() {
    file=$(find "$HOME"/.bin/* -type f | sed "s|$HOME/.bin/||" | fzf --print-query --query "$*" | tail -n 1)
    [ -z "$file" ] && return 1
    if [ -f "$HOME/.bin/$file" ]; then
        $EDITOR "$HOME/.bin/$file"
    else
        echo '#!/bin/sh' > "$HOME/.bin/$file" && chmod +x "$HOME/.bin/$file" && $EDITOR "$HOME/.bin/$file"
    fi
}
sn() {
    [ -f "$HOME/.bin/$1" ] && echo "script exists"  && return 1
    echo '#!/bin/sh' > "$HOME/.bin/$1" && chmod +x "$HOME/.bin/$1" && $EDITOR "$HOME/.bin/$1"
}

alias h='$(get_command)'

alias fl='ls | fzf --preview "cat {} || ls {}" --no-select-1'
